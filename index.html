<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#000000" />
    <link rel="stylesheet" href="css/styles.css">
    <title>D2 Name Picker</title>
</head>
<div class="backgroundImg">
    <img class="backgroundImg" src="img/diablobackground.png">
</div>
<button id="clickybutton" class="clickybutton"></button>
<body>
    <div id="preload">
        <img src="img/logo2.jpg" />
        <img src="img/pngegg.png" />
        <img src="img/diablobackground.png" />
        <img src="img/flamecircle1.png" />
</div>

<div class="quote">Not even death can save you from me...</div>
<div id='timer' class="hidden">Hello</div>
    <div class="mid-container flex">
        <div class="textbox">Enter character names one by one in the field below and press the add button for each entry<br><br>When done press calculate to receive<p class="chosen">The chosen</p>character name.</div>
        <div class="flex"><input id="textInput" placeholder="Enter character name" maxlength="12"></div>
        <div class="flex container">

                <button class="button" id="addButton">Add</button>


                <button class="button" id="button2">Calculate</button>

        </div>

    </div>
    <div class="evil">Evil has survived</div>
    <div class="videobot">
        <video class="video hidden" width="100%" controls autoplay loop playsinline muted>
            <source src="./vid/fire.webm" type="video/webm">
        </video>
    </div>
<script>
    const body = document.querySelector('body');
    const html = document.querySelector('html');
    const timerActual = document.getElementById('timer');
    const midContainer = document.querySelector('.mid-container');
    const audios = document.querySelectorAll('Audio');
    
    const lightScreen = document.createElement('div');
    const lightScreen2 = document.createElement('div');
    
    var flamevid = document.querySelector('.video');
    var audio = new Audio('audio/diablo-revised.mp3');
    audio.load()
    var quake = new Audio('audio/quake.mp3');
    var rubble = new Audio('audio/rubbleend.mp3');
    var quakeFull = new Audio('audio/quakefull.mp3');
    quake.load();
    rubble.load();
    quakeFull.load();
    flamevid.load();

    let clickAmount = 0
    const clkBtn = document.getElementById('clickybutton');
    clkBtn.onclick = function() {             // color swapper
        if (clickAmount > 49) {
            return addTimer()
        }
        if (clkBtn.style.backgroundColor == "maroon") {
        clkBtn.style.backgroundColor = "navy";
        clickAmount++
    } else {
        clkBtn.style.backgroundColor = "maroon"
        clickAmount++
    }
    console.log("hi");
}
function displayTimer() {
    lightScreen2.classList.add('whitein');
    body.appendChild(lightScreen2)
    midContainer.classList.add('hidden');
    midContainer.classList.remove('flex');
    timerActual.classList.remove('hidden');
    lightScreen2.addEventListener('animationend', function() {lightScreen2.classList.add('hidden')})
    flamevid.classList.remove('hidden');


}
function addTimer() {
    quake.addEventListener('ended', function(){displayTimer()})
lightScreen.classList.add('whiteout');
midContainer.appendChild(lightScreen);
html.classList.add('shake');
quake.play()
quakeFull.play()
//audios.forEach(Audio => Audio.addEventListener('ended', displayTimer))
}

    const fish = ["Snapper", "Hoki", "Tarakihi", ];
const addBtn = document.getElementById("addButton");
const submitBtn = document.getElementById("button2");
let inputField = document.querySelector("#textInput");
function chooseName(value = [ ]) { // name picker from array
    let nameCount = value.length;
    let chosenName = value[random(nameCount)];
    if (chosenName == (undefined || ' ')) {
        chooseName(value);
    } else {
        return chosenName;
    }
    
}
    function random(start, end) {
    if (end == undefined) {
        end = start;
        start = 0;
    }
    return (Math.floor(Math.random() * ((end) - start))) + start;
}


let arrayTest = ''
let arrayTestContent
let finalArray
function arrayCreator() {
    inputField = document.querySelector("#textInput");
    if (inputField.value != '') {
        if (arrayTest == '') {
    arrayTest += `"${inputField.value}"`;
    inputField.value = ""
        } else {
            arrayTest += `, "${inputField.value}"`;
    inputField.value = ""
        }
    } else {
        console.log("empty input")
    }
}
function arrayTestContentCreator() {
    arrayTestContent = `[${arrayTest}]`
    finalArray = JSON.parse(arrayTestContent)
    return finalArray;
}

addBtn.onclick = function() {
    arrayCreator()
    console.log(arrayTest)
    arrayTestContentCreator();
    console.log(arrayTestContent);
    console.log(finalArray)
}
submitBtn.onclick = function() {
displayMessage()
audio.play()
}
function displayMessage() {
const html = document.querySelector('html');

const panel = document.createElement('div');
panel.setAttribute('class', 'msgBox');
html.appendChild(panel);

const logo = document.createElement('img')
logo.setAttribute('src', 'img/logo2.jpg')
logo.setAttribute('class', 'logoImg');
panel.appendChild(logo);

const msg1 = document.createElement('p');
msg1.textContent = 'Venture forth';
panel.appendChild(msg1);

const msg3 = document.createElement('p');
msg3.setAttribute('class', 'heroName');
msg3.textContent = chooseName(finalArray);
panel.appendChild(msg3);

const msg2 = document.createElement('p');
msg2.textContent = 'Hell awaits...';
panel.appendChild(msg2);

const flame = document.createElement('img')
flame.setAttribute('src', 'img/flamecircle1.png')
flame.setAttribute('class', 'flame');
panel.appendChild(flame);

const closeBtn = document.createElement('img');
closeBtn.setAttribute('src', 'img/pngegg.png')
closeBtn.setAttribute('class', 'closeBtn');
closeBtn.textContent = 'x';
panel.appendChild(closeBtn);

closeBtn.onclick = function() {
  panel.parentNode.removeChild(panel);
}
}
document.getElementById("textInput")
    .addEventListener("keyup", function(event) {
    event.preventDefault();
    if (event.keyCode === 13) {
        document.getElementById("addButton").click();
    }
});
let countdownDate = new Date(Date.UTC(2021, 8, 23, 21, 0, 0))
let xyz = setInterval(function() {
    let currentTime = new Date(Date.now())
    let distance = countdownDate - currentTime;
    let days = Math.floor(distance / (1000 * 60 * 60 * 24))
    let hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    let minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    let seconds = Math.floor((distance % (1000 * 60)) / 1000); 

    document.getElementById('timer').innerHTML = hours + 'h ' + minutes + 'm ' + seconds + 's ';
}, 1000)


/*submitBtn.onclick = function() {
    let arrayTestContent = arrayTestContentCreator();
    return arrayTestContent;
    console.log("ahahahah");

    let arrayTest = ''
let arrayTestContent
function arrayCreator() {
    inputField = document.querySelector("#textInput");
    if (inputField.value != '') {
    arrayTest += `"${inputField.value}"` + ", ";
    inputField.value = ""
    } else {
        console.log("empty input")
    }
}
} */
</script>
</body>
</html>